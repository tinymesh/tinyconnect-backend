{channels, [
   #{
        channel => <<"usb-stick">>
      , autoconnect => true
      , plugins => [

            {tinyconnect_pty, #{
                 name      => <<"pty">>
               , subscribe => [{<<"usb-stick">>, [<<"gateway">>]}]
               , link      => <<"/tmp/tinyconnect/pty/", <<"usb-stick">>/binary>>
               }},

            {tinyconnect_tty, #{
                 name        => <<"gateway">>
               , start_after => [<<"pty">>]
               , subscribe   => [{<<"usb-stick">>, [<<"pty">>, <<"cloudsync">>]}]
               , port        => {path, "/dev/serial/by-id/usb-FTDI_FT232R_USB_UART_A503G9YR-if00-port0"}
               , portopts    => [{baud, 19200}, {flow_control, none}]
               , handshake   => wait_for_ack
               }},

            {tinyconnect_queue, #{
                 name        => <<"output-queue">>
               , queue       => 'usb-stick-out-queue'
               , subscribe   => [{<<"usb-stick">>, [<<"gateway">>]}]
               , accept      => {tinyconnect_tty, if_packet}
               }},

            {tinyconnect_cloudsync, #{
                 name        => <<"cloudsync">>
               , start_after => [<<"output-queue">>]
               , subscribe   => [{<<"usb-stick">>, [<<"output-queue">>]}]

               , remote      => <<"http://localhost:4000/_channels/io/I8/@tinymesh?raw=true&data.encoding=base64">>
               , auth        => {token, {
                     <<"fcaf2e758ac01085205e59bdc0682c58dcda349396360378cd108a6834cc156a">>,
                     <<"TZJC0CutVA3tfzJTys5M+QslQEiQHfAyJBIDQYdW9t1GvfuEUVpACtRYHaYImnx4biS8a5EiWU1pOer2gKE6iw==">>}}
            }}
      ]
   }
]}.
